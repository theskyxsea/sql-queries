SQL> select ename , job, sal*12 "Annual Sal" , deptno , dname from emp natural join dept where sal*12>=30000 AND JOB != 'CLERK';

ENAME      JOB       Annual Sal     DEPTNO DNAME
---------- --------- ---------- ---------- --------------
JONES      MANAGER        35700         20 RESEARCH
BLAKE      MANAGER        34200         30 SALES
SCOTT      ANALYST        36000         20 RESEARCH
KING       PRESIDENT      60000         10 ACCOUNTING
FORD       ANALYST        36000         20 RESEARCH

SQL> SELECT E1.EMPNO , E1.ENAME , E2.EMPNO , E2.ENAME FROM EMP E1 , EMP E2 WHERE E1.MGR=E2.EMPNO;

     EMPNO ENAME           EMPNO ENAME
---------- ---------- ---------- ----------
      7369 SMITH            7902 FORD
      7499 ALLEN            7698 BLAKE
      7521 WARD             7698 BLAKE
      7566 JONES            7839 KING
      7654 MARTIN           7698 BLAKE
      7698 BLAKE            7839 KING
      7782 CLARK            7839 KING
      7788 SCOTT            7566 JONES
      7844 TURNER           7698 BLAKE
      7876 ADAMS            7788 SCOTT
      7900 JAMES            7698 BLAKE
      7902 FORD             7566 JONES
      7934 MILLER           7782 CLARK

13 rows selected.

SQL> SELECT DNAME , ENAME FROM DEPT D LEFT JOIN EMP E ON E.DEPTNO=D.DEPTNO;

DNAME          ENAME
-------------- ----------
ACCOUNTING     CLARK
ACCOUNTING     KING
ACCOUNTING     MILLER
RESEARCH       JONES
RESEARCH       FORD
RESEARCH       ADAMS
RESEARCH       SMITH
RESEARCH       SCOTT
SALES          WARD
SALES          TURNER
SALES          ALLEN
SALES          JAMES
SALES          BLAKE
SALES          MARTIN
OPERATIONS

15 rows selected.

SQL> SELECT DNAME , SUM(SAL) FROM EMP RIGHT JOIN DEPT ON EMP.DEPTNO=DEPT.DEPTNO GROUP BY DNAME;

DNAME            SUM(SAL)
-------------- ----------
ACCOUNTING           8750
OPERATIONS
RESEARCH            10875
SALES                9400

SQL> SELECT ENAME, DNAME FROM EMP NATURAL JOIN DEPT;

ENAME      DNAME
---------- --------------
SMITH      RESEARCH
ALLEN      SALES
WARD       SALES
JONES      RESEARCH
MARTIN     SALES
BLAKE      SALES
CLARK      ACCOUNTING
SCOTT      RESEARCH
KING       ACCOUNTING
TURNER     SALES
ADAMS      RESEARCH
JAMES      SALES
FORD       RESEARCH
MILLER     ACCOUNTING

14 rows selected.

SQL> SELECT LOC FROM EMP NATURAL JOIN DEPT WHERE COMM IS NOT NULL;

LOC
-------------
CHICAGO
CHICAGO
CHICAGO
CHICAGO

SQL> SELECT DNAME FROM EMP NATURAL JOIN DEPT WHERE SAL=(SELECT MIN(SAL) FROM EMP) AND MGR IS NULL;

no rows selected

SQL> SELECT DNAME , LOC FROM EMP NATURAL JOIN DEPT WHERE MGR = (SELECT EMPNO FROM EMP WHERE ENAME='SMITH');

no rows selected

SQL> SELECT LOC FROM EMP E1,EMP E2 , EMP E3, DEPT D WHERE E1.MGR IN (E2.EMPNO) AND E2.MGR IN (E3.EMPNO) AND E3.DEPTNO=D.DEPTNO AND E1.JOB='SALESMAN';

LOC
-------------
NEW YORK
NEW YORK
NEW YORK
NEW YORK

SQL> SELECT ENAME FROM EMP NATURAL JOIN DEPT WHERE DNAME='RESEARCH' AND JOB='MANAGER';

ENAME
----------
JONES

SQL> SELECT COUNT(E3.SAL) FROM EMP E1,EMP E2,EMP E3 WHERE E1.MGR=E2.EMPNO AND E3.SAL<E2.SAL AND E1.ENAME='BLAKE';

COUNT(E3.SAL)
-------------
           13

SQL> SELECT ENAME , DNAME ,LOC FROM EMP NATURAL JOIN DEPT WHERE MGR=(SELECT EMPNO FROM EMP WHERE ENAME='BLAKE') AND JOB='ANALYST';

no rows selected

SQL> SELECT E2.ENAME , E2.HIREDATE, E2.COMM FROM EMP E1,EMP E2 WHERE E1.MGR=E2.EMPNO AND E1.ENAME='FORD';

ENAME      HIREDATE        COMM
---------- --------- ----------
JONES      02-APR-81

SQL> SELECT ENAME , DNAME FROM EMP NATURAL JOIN DEPT WHERE SAL<(SELECT AVG(SAL) FROM EMP GROUP BY DEPTNO HAVING DEPTNO=30);

ENAME      DNAME
---------- --------------
SMITH      RESEARCH
WARD       SALES
MARTIN     SALES
TURNER     SALES
ADAMS      RESEARCH
JAMES      SALES
MILLER     ACCOUNTING

7 rows selected.

SQL> SELECT E1.ENAME , DNAME , LOC FROM EMP E1, EMP E2, DEPT D WHERE E1.MGR=E2.EMPNO AND E1.DEPTNO=D.DEPTNO AND E2.ENAME='JONES';

ENAME      DNAME          LOC
---------- -------------- -------------
SCOTT      RESEARCH       DALLAS
FORD       RESEARCH       DALLAS

SQL> SELECT ENAME , DNAME FROM EMP NATURAL JOIN DEPT WHERE INSTR(ENAME,'S')=1;

ENAME      DNAME
---------- --------------
SMITH      RESEARCH
SCOTT      RESEARCH

SQL> SELECT DNAME FROM EMP E RIGHT JOIN DEPT D ON E.DEPTNO=D.DEPTNO GROUP BY DNAME HAVING COUNT(ENAME)=0;

DNAME
--------------
OPERATIONS

SQL> SELECT DNAME , ENAME FROM EMP E RIGHT JOIN DEPT D ON E.DEPTNO=D.DEPTNO;

DNAME          ENAME
-------------- ----------
ACCOUNTING     CLARK
ACCOUNTING     KING
ACCOUNTING     MILLER
RESEARCH       JONES
RESEARCH       FORD
RESEARCH       ADAMS
RESEARCH       SMITH
RESEARCH       SCOTT
SALES          WARD
SALES          TURNER
SALES          ALLEN
SALES          JAMES
SALES          BLAKE
SALES          MARTIN
OPERATIONS

15 rows selected.

SQL> SELECT ENAME , JOB , DNAME, LOC FROM EMP NATURAL JOIN DEPT WHERE JOB='MANAGER' AND LOC='CHICAGO';

ENAME      JOB       DNAME          LOC
---------- --------- -------------- -------------
BLAKE      MANAGER   SALES          CHICAGO

SQL> SELECT DNAME FROM EMP NATURAL JOIN DEPT WHERE HIREDATE BETWEEN '01-JAN-1981' AND '31-DEC-1982' AND SAL>1800;

DNAME
--------------
RESEARCH
SALES
ACCOUNTING
ACCOUNTING
RESEARCH

SQL> SELECT MIN(SAL) FROM EMP WHERE SAL!=(SELECT MIN(SAL) FROM EMP);

  MIN(SAL)
----------
       950
       
SQL> SELECT E1.ENAME , E2.ENAME FROM EMP E1,EMP E2 WHERE E1.MGR=E2.EMPNO;

ENAME      ENAME
---------- ----------
SMITH      FORD
ALLEN      BLAKE
WARD       BLAKE
JONES      KING
MARTIN     BLAKE
BLAKE      KING
CLARK      KING
SCOTT      JONES
TURNER     BLAKE
ADAMS      SCOTT
JAMES      BLAKE
FORD       JONES
MILLER     CLARK

13 rows selected.
